# تحديثات نظام المحاضر

## الميزات الجديدة المضافة

### 1. تخصيص المحاضر
تم إضافة إمكانية تخصيص المحاضر للأقسام والمجلدات واللجان بثلاث طرق:

#### خيارات التخصيص:
1. **تخصيص حسب القسم**: اختيار القسم والمجلد فقط
2. **تخصيص حسب اللجنة**: اختيار اللجنة ومجلد اللجنة فقط
3. **تخصيص حسب القسم واللجنة**: اختيار القسم والمجلد واللجنة معاً

#### الحقول الجديدة:
- **القسم (Department)**: اختيار القسم الذي ينتمي إليه المحضر
- **مجلد القسم (Department Folder)**: اختيار المجلد داخل القسم المحدد
- **اللجنة (Committee)**: اختيار اللجنة المرتبطة بالمحضر
- **مجلد اللجنة (Committee Folder)**: اختيار المجلد داخل اللجنة المحددة

### 2. التحديثات في الواجهة الأمامية

#### ملف HTML (`frontend/html/protocol-form.html`):
- إضافة قسم جديد "تخصيص المحضر" يحتوي على:
  - خيارات راديو لاختيار نوع التخصيص (قسم، لجنة، أو كلاهما)
  - قسم تخصيص القسم: Dropdown للقسم والمجلد
  - قسم تخصيص اللجنة: Dropdown للجنة ومجلد اللجنة

#### ملف JavaScript (`frontend/js/protocol-form.js`):
- إضافة وظائف تحميل الأقسام والمجلدات واللجان
- دالة تبديل نوع التخصيص (toggleAssignmentType)
- دالة تحميل مجلدات اللجنة (loadFoldersForCommittee)
- تحديث دالة جمع البيانات لتشمل الحقول الجديدة
- تحديث دالة إعادة تعيين النموذج

#### ملف CSS (`frontend/css/protocol-form.css`):
- إضافة تنسيقات للحقول الجديدة
- تنسيق خاص لقسم التخصيص

### 3. التحديثات في قاعدة البيانات

#### نموذج المحاضر (`backend/models/protocolModel.js`):
- إضافة الأعمدة الجديدة في جدول `protocols`:
  - `department_id` (INT)
  - `folder_id` (INT)
  - `committee_id` (INT)
- إضافة المفاتيح الأجنبية للربط مع الجداول الأخرى
- تحديث جميع الدوال لتشمل الحقول الجديدة

### 4. التحديثات في الترجمات

#### ملف اللغة (`frontend/js/language.js`):
- إضافة ترجمات جديدة:
  - `protocol-assignment`: "تخصيص المحضر"
  - `select-department`: "اختر القسم"
  - `select-folder`: "اختر المجلد"
  - `select-folder-first`: "اختر القسم أولاً"
  - `select-committee`: "اختر اللجنة"

## كيفية الاستخدام

### إنشاء محضر جديد:
1. أدخل المعلومات الأساسية (العنوان والتاريخ)
2. اختر نوع التخصيص:
   - **تخصيص حسب القسم**: اختر القسم ثم المجلد
   - **تخصيص حسب اللجنة**: اختر اللجنة ثم مجلد اللجنة
   - **تخصيص حسب القسم واللجنة**: اختر القسم والمجلد واللجنة معاً
3. أضف المواضيع
4. احفظ المحضر

### الميزات التفاعلية:
- **تبديل نوع التخصيص**: إظهار/إخفاء الحقول حسب النوع المختار
- **المجلدات**: يتم تفعيلها تلقائياً بعد اختيار القسم أو اللجنة
- **التحميل الديناميكي**: يتم تحميل البيانات من الخادم في الوقت الفعلي
- **التحقق من الصحة**: التحقق من صحة البيانات قبل الحفظ
- **إعادة تعيين**: إعادة تعيين جميع الحقول عند تغيير نوع التخصيص

## ملفات التحديث

### ملف SQL للتحديث:
- `update_protocols_table.sql`: لتحديث قاعدة البيانات

### تشغيل التحديثات:
1. تشغيل ملف SQL في قاعدة البيانات
2. إعادة تشغيل الخادم
3. اختبار الواجهة الأمامية

## ملاحظات مهمة

- جميع الحقول الجديدة اختيارية (يمكن تركها فارغة)
- يتم حفظ العلاقات في قاعدة البيانات مع المفاتيح الأجنبية
- تم الحفاظ على التوافق مع المحاضر الموجودة
- تم إضافة تنسيقات CSS لتحسين المظهر 
# تكامل المحاضر مع المجلدات

## الميزات الجديدة المضافة

### 1. عرض المحاضر في المجلدات
تم إضافة إمكانية عرض المحاضر المرتبطة بمجلد معين في نفس صفحة محتويات المجلد.

#### الميزات:
- **عرض المحاضر**: تظهر المحاضر المرتبطة بالمجلد في نفس الصفحة مع المحتويات الأخرى
- **تمييز بصري**: المحاضر لها تصميم مميز مع شريط أزرق على اليسار
- **معلومات مفصلة**: عرض عنوان المحضر، حالة الاعتماد، تاريخ المحضر، وعدد المواضيع
- **عرض المحضر**: إمكانية فتح المحضر في نافذة جديدة

### 2. التحديثات في الخلفية (Backend)

#### نموذج المحاضر (`backend/models/protocolModel.js`):
- إضافة دالة `getProtocolsByFolder()` لجلب المحاضر المرتبطة بمجلد معين

#### Controller المحاضر (`backend/controllers/protocolController.js`):
- إضافة دالة `getProtocolsByFolder()` للتعامل مع طلبات جلب المحاضر حسب المجلد

#### Routes المحاضر (`backend/routes/protocolRoutes.js`):
- إضافة route جديد: `GET /api/protocols/folder/:folderId`

### 3. التحديثات في الواجهة الأمامية

#### ملف JavaScript (`frontend/js/department-content.js`):
- تعديل دالة `fetchFolderContents()` لتشمل جلب المحاضر
- إضافة عرض المحاضر في نفس قائمة المحتويات
- إضافة مستمعي الأحداث لعرض المحاضر

#### ملف CSS (`frontend/css/department-content.css`):
- إضافة تنسيقات خاصة بالمحاضر (`.protocol-item`)
- تنسيقات عنوان قسم المحاضر (`.protocols-header`)
- تنسيقات زر عرض المحضر (`.view-protocol-icon`)

## كيفية العمل

### عند فتح مجلد:
1. يتم جلب المحتويات العادية للمجلد
2. يتم جلب المحاضر المرتبطة بنفس المجلد
3. يتم عرض المحتويات أولاً
4. يتم عرض المحاضر في قسم منفصل مع عنوان مميز

### تصميم المحاضر:
- **شريط أزرق**: على الجانب الأيسر لتمييز المحاضر عن المحتويات العادية
- **خلفية فاتحة**: لتمييز المحاضر بصرياً
- **أيقونة العين**: لفتح المحضر في نافذة جديدة
- **معلومات مفصلة**: عنوان، حالة الاعتماد، تاريخ، عدد المواضيع

## API الجديد

### جلب المحاضر حسب المجلد:
```
GET /api/protocols/folder/:folderId
```

#### الاستجابة:
```json
{
  "success": true,
  "data": [
    {
      "id": 1,
      "title": "عنوان المحضر",
      "protocol_date": "2024-01-15",
      "created_at": "2024-01-15T10:00:00Z",
      "status": "active",
      "approval_status": "approved",
      "is_approved": true,
      "file_path": "path/to/file.pdf",
      "created_by_name": "اسم المنشئ",
      "topics_count": 5,
      "latest_end_date": "2024-02-15"
    }
  ],
  "message": "تم جلب المحاضر بنجاح"
}
```

## ملاحظات مهمة

- المحاضر تظهر فقط في المجلدات التي تم ربطها بها عند الإنشاء
- يمكن ربط محضر واحد بمجلد واحد فقط
- المحاضر تظهر مع المحتويات العادية في نفس الصفحة
- تم الحفاظ على التصميم المتناسق مع باقي النظام
- إمكانية فتح المحضر في نافذة جديدة لعرض التفاصيل الكاملة

## الخطوات التالية

1. تشغيل ملف `update_protocols_table.sql` في قاعدة البيانات
2. إعادة تشغيل الخادم
3. اختبار إنشاء محضر جديد وربطه بمجلد
4. اختبار عرض المحضر في صفحة المجلد 